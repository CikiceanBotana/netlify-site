<!DOCTYPE html>
<html lang="ro">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Meniu Restaurant</title>
    <script src="https://identity.netlify.com/v1/netlify-identity-widget.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/react/18.2.0/umd/react.production.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/react-dom/18.2.0/umd/react-dom.production.min.js"></script>
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
</head>
<body>
    <div id="root"></div>
    <script>
        // Define components
        const MenuItem = ({ item }) => {
            const [isExpanded, setIsExpanded] = React.useState(false);

            if (!item) return null;

            return React.createElement('div', { 
                className: "bg-white rounded-lg shadow-md p-4 mb-4 transition-all duration-300 hover:shadow-lg" 
            }, [
                React.createElement('div', { 
                    key: 'header',
                    className: "flex justify-between items-center" 
                }, [
                    React.createElement('div', { key: 'title' }, [
                        React.createElement('h3', { 
                            key: 'name',
                            className: "text-lg font-semibold text-gray-800" 
                        }, item.name),
                        React.createElement('p', { 
                            key: 'portion',
                            className: "text-sm text-gray-600" 
                        }, `Porție: ${item.portion}`)
                    ]),
                    React.createElement('button', {
                        key: 'button',
                        onClick: () => setIsExpanded(!isExpanded),
                        className: "px-4 py-2 bg-blue-500 text-white rounded-md hover:bg-blue-600 transition-colors"
                    }, isExpanded ? 'Mai puține detalii' : 'Mai multe detalii')
                ]),
                isExpanded && React.createElement('div', {
                    key: 'details',
                    className: "mt-4 p-4 bg-gray-50 rounded-md"
                }, [
                    React.createElement('div', {
                        key: 'grid',
                        className: "grid grid-cols-1 md:grid-cols-2 gap-4"
                    }, [
                        React.createElement('div', { key: 'ingredients' }, [
                            React.createElement('h4', { 
                                className: "font-semibold text-gray-700 mb-2" 
                            }, "Ingrediente"),
                            React.createElement('p', { 
                                className: "text-sm text-gray-600" 
                            }, item.ingredients)
                        ]),
                        React.createElement('div', { key: 'nutrition' }, [
                            React.createElement('h4', { 
                                className: "font-semibold text-gray-700 mb-2" 
                            }, "Informații Nutriționale"),
                            React.createElement('ul', { 
                                className: "text-sm text-gray-600" 
                            }, [
                                React.createElement('li', { key: 'calories' }, `Calorii: ${item.nutritionalInfo?.calories}`),
                                React.createElement('li', { key: 'fats' }, `Grăsimi: ${item.nutritionalInfo?.fats}`),
                                React.createElement('li', { key: 'protein' }, `Proteine: ${item.nutritionalInfo?.protein}`),
                                React.createElement('li', { key: 'carbs' }, `Carbohidrați: ${item.nutritionalInfo?.carbs}`),
                                React.createElement('li', { key: 'salt' }, `Sare: ${item.nutritionalInfo?.salt}`)
                            ])
                        ])
                    ]),
                    (item.allergens || item.additives) && React.createElement('div', {
                        key: 'warnings',
                        className: "mt-4"
                    }, [
                        item.allergens && React.createElement('p', { 
                            key: 'allergens',
                            className: "text-sm text-red-600" 
                        }, [
                            React.createElement('span', { 
                                className: "font-semibold" 
                            }, "Alergeni: "),
                            item.allergens
                        ]),
                        item.additives && React.createElement('p', { 
                            key: 'additives',
                            className: "text-sm text-orange-600" 
                        }, [
                            React.createElement('span', { 
                                className: "font-semibold" 
                            }, "Aditivi: "),
                            item.additives
                        ])
                    ])
                ])
            ]);
        };

        const MenuList = () => {
            const [menuData, setMenuData] = React.useState([]);
            const [loading, setLoading] = React.useState(true);
            const [error, setError] = React.useState(null);

            React.useEffect(() => {
                console.log('Fetching menu data...');
                fetch('/menu-items.json')
                    .then(response => {
                        console.log('Response status:', response.status);
                        if (!response.ok) {
                            throw new Error(`HTTP error! status: ${response.status}`);
                        }
                        return response.json();
                    })
                    .then(data => {
                        console.log('Menu data received:', data);
                        setMenuData(Array.isArray(data) ? data : []);
                        setLoading(false);
                    })
                    .catch(error => {
                        console.error('Error loading menu:', error);
                        setError(error.message);
                        setLoading(false);
                    });
            }, []);

            if (loading) {
                return React.createElement('div', {
                    className: "min-h-screen bg-gray-100 flex items-center justify-center"
                }, React.createElement('div', {
                    className: "text-xl text-gray-600"
                }, "Se încarcă meniul..."));
            }

            if (error) {
                return React.createElement('div', {
                    className: "min-h-screen bg-gray-100 flex items-center justify-center"
                }, React.createElement('div', {
                    className: "text-xl text-red-600"
                }, `Eroare: ${error}`));
            }

            return React.createElement('div', {
                className: "min-h-screen bg-gray-100"
            }, React.createElement('div', {
                className: "container mx-auto px-4 py-8"
            }, [
                React.createElement('header', {
                    key: 'header',
                    className: "text-center mb-12"
                }, [
                    React.createElement('h1', {
                        key: 'title',
                        className: "text-4xl font-bold text-gray-900 mb-4"
                    }, "Meniul Nostru"),
                    React.createElement('p', {
                        key: 'description',
                        className: "text-gray-600"
                    }, menuData.length === 0 
                        ? "Nu există încă preparate în meniu."
                        : "Apăsați pe \"Mai multe detalii\" pentru a vedea informațiile nutriționale și ingredientele")
                ]),
                React.createElement('div', {
                    key: 'menu-items',
                    className: "max-w-3xl mx-auto"
                }, menuData.map((item, index) => 
                    React.createElement(MenuItem, { key: index, item: item })
                ))
            ]));
        };

        // Initialize app
        try {
            const root = ReactDOM.createRoot(document.getElementById('root'));
            root.render(React.createElement(MenuList));
        } catch (error) {
            console.error('Error rendering app:', error);
        }

        // Identity handling
        if (window.netlifyIdentity) {
            window.netlifyIdentity.on("init", user => {
                if (!user) {
                    window.netlifyIdentity.on("login", () => {
                        document.location.href = "/admin/";
                    });
                }
            });
        }
    </script>
</body>
</html>
